---
title: "fsbrain examples"
author: "Tim Sch√§fer"
date: "April 23, 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rgl::setupKnitr()
```

# fsbrain Visualization Examples

## Example data

First we specify a subjects dir and the subject we want to use. Feel free to replace this with your data.

```{r}
library('fsbrain')
sjd = '~/data/subject1_only'
sj = 'subject1'
```

Now increase the figure size.

```{r}
library('rgl')
r3dDefaults$windowRect=c(0, 0, 800, 800);
```

## Visualizing native space morphometry data: cortical thickness

Let's start with a basic example and plot cortical thickness on the surface of our demo subject:

```{r rgl=TRUE, dev='png'}
vis.subject.morph.native(sjd, sj, 'thickness')
```

This loaded the morphometry data files `surf/lh.thickness` and `surf/rh.thickness` of the subject, applied a colormap to the values, and visualized the results on the white surface, i.e., the brain surface meshes in the files `surf/lh.white` and `surf/rh.white`.

The default view above shows the brain from four different angles in four tiles and is called `t4` view. Maybe you prefer a different view? In addition, let's mask the medial wall (the large blue parts in the lower two tiles).

```{r rgl=TRUE, dev='png'}
vis.subject.morph.native(sjd, sj, 'thickness', views='t9', cortex_only = TRUE)
```

Next, we will try a third view, add a colorbar, use the pial surface, and plot something different.

```{r rgl=TRUE, dev='png'}
vis.subject.morph.native(sjd, sj, 'volume', views='si', cortex_only = TRUE, draw_colorbar = 'vertical', surface = 'pial')
```

That does not look very exciting. Why? The volume data has a tail:

```{r}
hist(subject.morph.native(sjd, sj, 'volume', hemi = 'both'))
```

There are various solutions to this problem,
