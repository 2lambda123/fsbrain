---
title: "fsbrain advanced visualization examples"
author: "Tim Sch√§fer"
date: "June 24, 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rgl::setupKnitr()
```


## Example data

First we specify a subjects dir and the subject we want to use. Feel free to replace this with your data.

```{r}
library('fsbrain')
sjd = '~/data/subject1_only'
sj = 'subject1'
```

Now increase the figure size.

```{r}
fsbrain.set.default.figsize(1000, 1000);
```


## Eporting (almost) publication-ready plots

The `vis.export.*` functions provide a high-level interface to export plots. They require the `magick` package.

```{r rgl=TRUE, fig.show = 'hide'}
cm = vis.subject.morph.standard(sjd, sj, 'sulc', rglactions=list('no_vis'=T));
img = vis.export.from.coloredmeshes(cm, colorbar_legend='Sulcal depth [mm]');
```

The image gets exported as a PNG file into the current working directory by default, and you can set the 'output_img' parameter to save it wherever you want. One can also show it directly:

```{r}
img;
```


## Group visualization: atlas annotations

You can use fsbrain to plot data for a group of subjects, combined into a single output image. First we define our subjects list, then we plot the Desikan atlas parcellation for all of them:

```{r rgl=TRUE, fig.show = 'hide'}
sjd = '~/data/study1'
sjl = paste('subject', 1:13, sep=""); # our subjects list: subject1, subject2, ... , subject13
img = vis.group.annot(sjd, sjl, 'aparc');
```

The same output image rules as explained above are in place. Once more, to see the image:

```{r}
img;
```

## Group visualization: native space morphometry data

## Group visualization: standard space morphometry data

### Visualizing vertex-wise mean values for a group

If you have native space data for a group of subjects, you can plot the mean value over all subjects at every vertex using the `vis.subject.morph.standard` function. Just pass your subjects list (`sjl` in the example above) for the 'subject_id' parameter.

### Visualizing pre-loaded data for a group

To visualize pre-loaded data on a group of subjects, use `vis.data.on.group.native` and `vis.data.on.group.standard`.  

## Learning more

To learn more, read the vignettes:

```{r, eval = FALSE}
browseVignettes('fsbrain');
```

In general, the vignettes are a great way to get started with *fsbrain*. You can also read them online at CRAN, they are linked on the [fsbrain page on GitHub](https://github.com/dfsp-spirit/fsbrain).

